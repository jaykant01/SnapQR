<div class="min-h-screen bg-gradient-to-b from-[#e8f3ff] to-[#f5fbff]">

  <!-- NAVBAR -->
  <nav class="w-full bg-blue-200 shadow-sm fixed top-0 left-0 right-0 z-50">
    <div class="max-w-7xl mx-auto px-6 h-16 flex items-center justify-between">

      <!-- Logo -->
      <div class="flex items-center gap-3 cursor-pointer" routerLink="/">
        <div class="w-10 h-10 rounded-lg bg-gradient-to-br  flex items-center justify-center shadow">
          <img width="64" height="64" src="https://img.icons8.com/nolan/64/qr-code.png" alt="qr-code"/>
        </div>
        <span class="text-xl font-semibold text-gray-800">QR Service</span>
      </div>

      <!-- Right Profile -->
      <div class="relative">
        <button
          (click)="toggleMenu()"
          class="w-10 h-10 rounded-full border border-gray-300 bg-white flex items-center justify-center shadow-sm hover:shadow transition"
        >
          <img width="50" height="50" src="https://img.icons8.com/color/96/user-male-circle--v1.png" alt="user-male-circle--v1"/>
        </button>

        <!-- Profile Dropdown -->
        <div
          *ngIf="menuOpen"
          class="absolute right-0 mt-3 w-60 bg-white shadow-xl rounded-lg border p-4 z-50"
        >
          <!-- Heading -->
          <div class="text-medium font-semibold text-gray-700 mb-1">
            Profile Details
          </div>

          <!-- User Info -->
          <div class="space-y-1 pb-3 border-b">
            <div class="text-sm text-indigo-600 font-semibold uppercase tracking-wide">
              {{ role }}
            </div>
            <div class="font-medium text-gray-900">{{ username }}</div>
            <div class="text-medium text-purple-500">{{ email }}</div>
          </div>

          <!-- Logout -->
          <button
            (click)="logout()"
            class="w-full text-left text-red-600 font-semibold py-3 hover:bg-red-400 rounded-md mt-2 transition"
          >
            Logout
          </button>
        </div>
      </div>

    </div>
  </nav>

  <!-- QR VIEW MODAL -->
  <div
    *ngIf="viewModalOpen"
    class="fixed inset-0 backdrop-blur-md bg-white/10 flex items-center justify-center z-[100]"
  >
    <div
      class="bg-white/70 backdrop-blur-xl rounded-2xl shadow-2xl p-6 w-11/12 sm:w-[380px] relative animate-fadeIn border border-white/30"
    >

      <!-- Close Button -->
      <button
        (click)="closeViewModal()"
        class="absolute top-3 right-3 text-gray-600 hover:text-gray-800 text-xl"
      >
        ✕
      </button>

      <!-- Title -->
      <h2 class="text-2xl font-semibold text-center mb-6 text-gray-800">
        QR Code Preview
      </h2>

      <!-- QR Image -->
      <div class="w-full flex justify-center mb-5">
        <img
          *ngIf="viewImageUrl"
          [src]="viewImageUrl"
          alt="QR Code"
          class="w-60 h-60 object-contain rounded-xl shadow"
        />
      </div>

      <!-- QR Info -->
      <div class="bg-white/60 rounded-xl p-4 shadow-inner">
        <p class="text-sm text-gray-700">
          <span class="font-semibold">Content:</span>
          <span class="text-gray-800 break-words">{{ viewContent }}</span>
        </p>

        <p class="text-sm text-gray-700 mt-2">
          <span class="font-semibold">Type:</span>
          <span class="text-blue-600 font-medium uppercase">{{ viewType }}</span>
        </p>
      </div>

    </div>
  </div>



  <!-- MAIN CONTENT -->
  <div class="pt-28 px-6 max-w-7xl mx-auto">

    <!-- Header -->
    <div class="flex justify-between items-center mb-8">
      <div>
        <h1 class="text-4xl font-bold text-[#0b2b49]">Dashboard</h1>
        <p class="text-gray-500 mt-1">Manage your QR codes and account settings</p>
      </div>

      <!-- Create Button -->
      <button
        routerLink="/generate"
        class="flex items-center gap-2 px-5 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-lg shadow"
      >
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="12" y1="5" x2="12" y2="19"/>
          <line x1="5" y1="12" x2="19" y2="12"/>
        </svg>
        Create QR Code
      </button>
    </div>

    <!-- QR History Box -->
    <div class="bg-white border rounded-2xl shadow-sm p-6 mb-10">

      <div>
        <h2 class="text-xl font-semibold">QR Code History</h2>
        <p class="text-sm text-gray-500">You have created {{ totalQrs }} QR codes total</p>
      </div>

      <!-- List -->
      <div *ngIf="qrCodes.length > 0" class="mt-6 space-y-3">

        <div
          *ngFor="let qr of qrCodes"
          class="flex flex-col lg:flex-row justify-between items-start lg:items-center
             p-4 bg-gray-50 border rounded-xl hover:bg-gray-100 transition gap-4"
        >

          <!-- Left -->
          <div class="flex items-start gap-4 w-full lg:w-auto">

            <!-- Icon -->
            <div class="w-14 h-14 bg-white border rounded-lg flex items-center justify-center flex-shrink-0">
              <svg width="38" height="38" viewBox="0 0 24 24" fill="#1f2937">
                <rect x="3" y="3" width="7" height="7" rx="1"/>
                <rect x="14" y="3" width="7" height="7" rx="1"/>
                <rect x="3" y="14" width="7" height="7" rx="1"/>
                <rect x="14" y="14" width="3" height="3"/>
                <rect x="18" y="14" width="3" height="3"/>
                <rect x="14" y="18" width="3" height="3"/>
              </svg>
            </div>

            <!-- Details -->
            <div class="min-w-0">
              <h3 class="font-semibold">{{ qr.name || "QR Code" }}</h3>
              <p class="text-sm text-gray-500 truncate max-w-full sm:max-w-md">{{ qr.content }}</p>
              <p class="text-xs text-gray-400 mt-1">
                Created: {{ qr.createdAt | date }} • {{ qr.scans || 0 }} scans
              </p>
            </div>

          </div>

          <!-- Right actions -->
          <div class="flex gap-4 w-full lg:w-auto justify-between lg:justify-end">

            <button (click)="viewQRCode(qr.id)"
                    class="text-blue-600 hover:bg-blue-50 p-2 rounded-lg transition flex items-center justify-center"
                    title="View"
            >
              <svg xmlns="http://www.w3.org/2000/svg"
                   width="18"
                   height="18"
                   viewBox="0 0 24 24"
                   fill="none"
                   stroke="currentColor"
                   stroke-width="2"
                   stroke-linecap="round"
                   stroke-linejoin="round"
                   class="flex-shrink-0">

                <!-- Perfectly centered Eye Icon -->
                <path d="M1 12s4-7 11-7 11 7 11 7-4 7-11 7S1 12 1 12z"/>
                <circle cx="12" cy="12" r="3"/>
              </svg>
            </button>


            <button
              (click)="downloadQRCode(qr.id)"
              class="text-green-600 hover:bg-green-50 p-2 rounded-lg transition flex items-center justify-center"
              title="Download"
            >
              <svg xmlns="http://www.w3.org/2000/svg"
                   width="18" height="18"
                   fill="currentColor"
                   class="bi bi-cloud-arrow-down"
                   viewBox="0 0 16 16">
                <path fill-rule="evenodd"
                      d="M7.646 10.854a.5.5 0 0 0 .708 0l2-2a.5.5 0 0 0-.708-.708L8.5
             9.293V5.5a.5.5 0 0 0-1 0v3.793L6.354 8.146a.5.5 0 1 0-.708.708z" />
                <path
                  d="M4.406 3.342A5.53 5.53 0 0 1 8 2c2.69 0 4.923 2
         5.166 4.579C14.758 6.804 16 8.137 16 9.773
         16 11.569 14.502 13 12.687 13H3.781C1.708 13
         0 11.366 0 9.318c0-1.763 1.266-3.223
         2.942-3.593.143-.863.698-1.723
         1.464-2.383m.653.757c-.757.653-1.153
         1.44-1.153 2.056v.448l-.445.049C2.064
         6.805 1 7.952 1 9.318 1 10.785 2.23 12
         3.781 12h8.906C13.98 12 15 10.988
         15 9.773c0-1.216-1.02-2.228-2.313-2.228h-.5v-.5
         C12.188 4.825 10.328 3 8 3a4.53 4.53
         0 0 0-2.941 1.1z" />
              </svg>
            </button>


            <!-- Delete (your icon) -->
            <button
              (click)="deleteQRCode(qr.id)"
              class="text-red-600 hover:bg-red-50 p-2 rounded-lg transition flex items-center justify-center"
              title="Delete">
              <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor"
                   class="bi bi-trash" viewBox="0 0 16 16">
                <path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1
               0V6a.5.5 0 0 1 .5-.5m2.5
               0a.5.5 0 0 1 .5.5v6a.5.5
               0 0 1-1 0V6a.5.5 0 0 1
               .5-.5m3 .5a.5.5 0 0 0-1
               0v6a.5.5 0 0 0 1 0z"/>
                <path d="M14.5 3a1 1 0 0 1-1
               1H13v9a2 2 0 0 1-2
               2H5a2 2 0 0 1-2-2V4h-.5a1
               1 0 0 1-1-1V2a1 1 0 0 1
               1-1H6a1 1 0 0 1 1-1h2a1
               1 0 0 1 1 1h3.5a1 1 0 0 1
               1 1zM4.118 4 4 4.059V13a1
               1 0 0 0 1 1h6a1 1 0 0 0
               1-1V4.059L11.882 4zM2.5
               3h11V2h-11z"/>
              </svg>
            </button>

          </div>


        </div>

      </div>

      <!-- EMPTY -->
      <div *ngIf="qrCodes.length === 0" class="text-center py-16">
        <div class="w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4">
          <svg width="34" height="34" viewBox="0 0 24 24" fill="none" stroke="#A0AEC0" stroke-width="2">
            <circle cx="12" cy="12" r="10"/>
            <polyline points="12 6 12 12 16 14"/>
          </svg>
        </div>
        <h3 class="text-lg font-medium">No QR codes yet.</h3>
        <p class="text-sm text-gray-500">Create your first one!</p>
      </div>

    </div>


  </div>
</div>
